# RISC-V M Extension Implementation Architecture

## ä¿®æ”¹æ¦‚è§ˆ (Modification Overview)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Assassyn-CPU Architecture                    â”‚
â”‚                        (5-Stage Pipeline)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”
â”‚  IF   â”‚â”€â”€â”€â–¶â”‚  ID   â”‚â”€â”€â”€â–¶â”‚  EX   â”‚â”€â”€â”€â–¶â”‚  MEM  â”‚â”€â”€â”€â–¶â”‚  WB   â”‚
â”‚ Fetch â”‚    â”‚Decode â”‚    â”‚Executeâ”‚    â”‚Memory â”‚    â”‚Write  â”‚
â”‚       â”‚    â”‚       â”‚    â”‚       â”‚    â”‚Access â”‚    â”‚Back   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”¬â”€â”€â”€â”˜    â””â”€â”€â”€â”¬â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚            â”‚
                 â”‚ Modified   â”‚ Modified
                 â”‚ Files:     â”‚ Files:
                 â”‚            â”‚
                 â–¼            â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ decoder.py  â”‚  â”‚execution.py â”‚
        â”‚             â”‚  â”‚             â”‚
        â”‚ + funct7    â”‚  â”‚ + MUL ops   â”‚
        â”‚   parsing   â”‚  â”‚ + DIV ops   â”‚
        â”‚             â”‚  â”‚ + REM ops   â”‚
        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
               â”‚                â”‚
               â–¼                â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   control_signals.py        â”‚
        â”‚                             â”‚
        â”‚   ALUOp: Bits(16) â†’ Bits(32)â”‚
        â”‚   + 8 new opcodes           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   instruction_table.py      â”‚
        â”‚                             â”‚
        â”‚   rv32i_table               â”‚
        â”‚   + 8 M-ext entries         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## M Extension æŒ‡ä»¤ç¼–ç  (Instruction Encoding)

```
R-Type Format (æ‰€æœ‰ M-extension æŒ‡ä»¤):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬
â”‚ funct7  â”‚ rs2 â”‚ rs1 â”‚ funct3 â”‚ rd  â”‚ opcode â”‚
â”‚ [31:25] â”‚[24:20]â”‚[19:15]â”‚[14:12]â”‚[11:7]â”‚[6:0] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    7        5     5      3       5       7

M Extension ç‰¹å¾:
- opcode  = 0110011 (OP_R_TYPE, ä¸Ž ADD/SUB ç›¸åŒ)
- funct7  = 0000001 (ä¸ŽåŸºç¡€æŒ‡ä»¤çš„ 0000000 åŒºåˆ†)
- funct3  = 000~111 (åŒºåˆ† 8 ç§æ“ä½œ)

æŒ‡ä»¤æ˜ å°„:
funct3  â”‚ æŒ‡ä»¤   â”‚ æ“ä½œ
â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  000   â”‚ MUL    â”‚ rd = (rs1 Ã— rs2)[31:0]
  001   â”‚ MULH   â”‚ rd = (rs1 Ã— rs2)[63:32] (signedÃ—signed)
  010   â”‚ MULHSU â”‚ rd = (rs1 Ã— rs2)[63:32] (signedÃ—unsigned)
  011   â”‚ MULHU  â”‚ rd = (rs1 Ã— rs2)[63:32] (unsignedÃ—unsigned)
  100   â”‚ DIV    â”‚ rd = rs1 Ã· rs2 (signed)
  101   â”‚ DIVU   â”‚ rd = rs1 Ã· rs2 (unsigned)
  110   â”‚ REM    â”‚ rd = rs1 % rs2 (signed)
  111   â”‚ REMU   â”‚ rd = rs1 % rs2 (unsigned)
```

## æ‰§è¡Œå•å…ƒæ‰©å±• (Execution Unit Extension)

```
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚   Decoder Output    â”‚
                      â”‚                     â”‚
                      â”‚  alu_func (Bits32)  â”‚
                      â”‚  rs1_data, rs2_data â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚  Operand Forwarding â”‚
                      â”‚                     â”‚
                      â”‚  Bypass: EX/MEM/WB  â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                                 â”‚
                â–¼                                 â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Existing ALU Ops   â”‚         â”‚   NEW: M-Ext Ops    â”‚
    â”‚                     â”‚         â”‚                     â”‚
    â”‚  â€¢ ADD   â€¢ SLL      â”‚         â”‚  â€¢ MUL   â€¢ DIV      â”‚
    â”‚  â€¢ SUB   â€¢ SLT      â”‚         â”‚  â€¢ MULH  â€¢ DIVU     â”‚
    â”‚  â€¢ AND   â€¢ SLTU     â”‚         â”‚  â€¢ MULHSU â€¢ REM     â”‚
    â”‚  â€¢ OR    â€¢ SRL      â”‚         â”‚  â€¢ MULHU  â€¢ REMU    â”‚
    â”‚  â€¢ XOR   â€¢ SRA      â”‚         â”‚                     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                               â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚  Result Multiplexer   â”‚
                  â”‚                       â”‚
                  â”‚  select1hot(32 slots) â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚   Bypass Register     â”‚
                  â”‚   ex_bypass[0]        â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚   To MEM Stage        â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ä¹˜æ³•å®žçŽ°ç»†èŠ‚ (Multiplication Implementation - Radix-4 Booth + Wallace Tree)

```
è¾“å…¥: rs1 (32-bit), rs2 (32-bit)
è¾“å‡º: rd (32-bit)
å‘¨æœŸæ•°: 2-3 cycles

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Multi-Cycle Multiplier Unit                    â”‚
â”‚         (Radix-4 Booth + Wallace Tree)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚        Cycle 1: Booth Encoding          â”‚             â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚
â”‚  â”‚  rs2 (32-bit Multiplier)                â”‚             â”‚
â”‚  â”‚      â”‚                                   â”‚             â”‚
â”‚  â”‚      â–¼                                   â”‚             â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚             â”‚
â”‚  â”‚  â”‚ Radix-4 Encoder  â”‚                   â”‚             â”‚
â”‚  â”‚  â”‚  Scan 3 bits     â”‚                   â”‚             â”‚
â”‚  â”‚  â”‚  at a time       â”‚                   â”‚             â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚             â”‚
â”‚  â”‚           â”‚                              â”‚             â”‚
â”‚  â”‚           â–¼                              â”‚             â”‚
â”‚  â”‚  17 Booth Coefficients                  â”‚             â”‚
â”‚  â”‚  {-2, -1, 0, +1, +2}                    â”‚             â”‚
â”‚  â”‚           â”‚                              â”‚             â”‚
â”‚  â”‚           â–¼                              â”‚             â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚             â”‚
â”‚  â”‚  â”‚ Partial Product  â”‚                   â”‚             â”‚
â”‚  â”‚  â”‚   Generator      â”‚                   â”‚             â”‚
â”‚  â”‚  â”‚  (17 products)   â”‚                   â”‚             â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚              â”‚                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚        Cycle 2: Wallace Tree            â”‚             â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚
â”‚  â”‚           â–¼                              â”‚             â”‚
â”‚  â”‚  17 Partial Products (64-bit each)      â”‚             â”‚
â”‚  â”‚           â”‚                              â”‚             â”‚
â”‚  â”‚           â–¼                              â”‚             â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚             â”‚
â”‚  â”‚  â”‚  Reduction Tree  â”‚                   â”‚             â”‚
â”‚  â”‚  â”‚  (CSA Network)   â”‚                   â”‚             â”‚
â”‚  â”‚  â”‚                  â”‚                   â”‚             â”‚
â”‚  â”‚  â”‚  Layer 1: 17â†’12  â”‚  (5 CSA + 2 HA)  â”‚             â”‚
â”‚  â”‚  â”‚  Layer 2: 12â†’8   â”‚  (4 CSA)          â”‚             â”‚
â”‚  â”‚  â”‚  Layer 3:  8â†’6   â”‚  (2 CSA + 2 HA)  â”‚             â”‚
â”‚  â”‚  â”‚  Layer 4:  6â†’4   â”‚  (2 CSA)          â”‚             â”‚
â”‚  â”‚  â”‚  Layer 5:  4â†’3   â”‚  (1 CSA + 1 HA)  â”‚             â”‚
â”‚  â”‚  â”‚  Layer 6:  3â†’2   â”‚  (1 CSA)          â”‚             â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚             â”‚
â”‚  â”‚           â”‚                              â”‚             â”‚
â”‚  â”‚           â–¼                              â”‚             â”‚
â”‚  â”‚  Sum (64-bit) + Carry (64-bit)          â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚              â”‚                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚      Cycle 2-3: Final Adder             â”‚             â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚
â”‚  â”‚           â–¼                              â”‚             â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚             â”‚
â”‚  â”‚  â”‚  Carry Lookahead â”‚                   â”‚             â”‚
â”‚  â”‚  â”‚      Adder       â”‚                   â”‚             â”‚
â”‚  â”‚  â”‚    (64-bit)      â”‚                   â”‚             â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚             â”‚
â”‚  â”‚           â”‚                              â”‚             â”‚
â”‚  â”‚           â–¼                              â”‚             â”‚
â”‚  â”‚    64-bit Result                         â”‚             â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚             â”‚
â”‚  â”‚   â”‚                 â”‚                   â”‚             â”‚
â”‚  â”‚   â–¼                 â–¼                   â”‚             â”‚
â”‚  â”‚ [63:32]         [31:0]                  â”‚             â”‚
â”‚  â”‚  High            Low                    â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚         â”‚              â”‚                                  â”‚
â”‚    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”                           â”‚
â”‚    â”‚  MULH   â”‚    â”‚   MUL   â”‚                           â”‚
â”‚    â”‚ MULHSU  â”‚    â”‚         â”‚                           â”‚
â”‚    â”‚ MULHU   â”‚    â”‚         â”‚                           â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Radix-4 Booth ç¼–ç è§„åˆ™:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ y[i+1] y[i] y[i-1] â”‚  æ“ä½œ              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   0     0     0    â”‚   0 Ã— Multiplicand â”‚
â”‚   0     0     1    â”‚  +1 Ã— Multiplicand â”‚
â”‚   0     1     0    â”‚  +1 Ã— Multiplicand â”‚
â”‚   0     1     1    â”‚  +2 Ã— Multiplicand â”‚
â”‚   1     0     0    â”‚  -2 Ã— Multiplicand â”‚
â”‚   1     0     1    â”‚  -1 Ã— Multiplicand â”‚
â”‚   1     1     0    â”‚  -1 Ã— Multiplicand â”‚
â”‚   1     1     1    â”‚   0 Ã— Multiplicand â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Wallace Tree åŽ‹ç¼©ç¤ºæ„:
    17ä¸ªéƒ¨åˆ†ç§¯
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚   CSA   â”‚  Carry Save Adder (3:2 åŽ‹ç¼©)
    â”‚   HA    â”‚  Half Adder (2:2 åŽ‹ç¼©)
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â”‚
    é‡å¤å¤šå±‚ç›´è‡³å‰©ä½™2ä¸ªæ“ä½œæ•°
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚  CLA/   â”‚  æœ€ç»ˆåŠ æ³•å™¨
    â”‚  RCA    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ€§èƒ½ç‰¹æ€§:
- å»¶è¿Ÿ: 2-3 å‘¨æœŸï¼ˆå–å†³äºŽç›®æ ‡é¢‘çŽ‡ï¼‰
- é¢ç§¯: ~200 LUTs + 2-4 DSP blocks
- åŠŸè€—: ä¸­ç­‰ï¼ˆç›¸æ¯”å•å‘¨æœŸä¹˜æ³•å™¨æ›´ä½Žï¼‰
- å¯ç»¼åˆæ€§: ä¼˜ç§€ï¼ˆFPGAå‹å¥½ï¼‰


## é™¤æ³•å®žçŽ°ç»†èŠ‚ (Division Implementation - Non-restoring Algorithm)

```
è¾“å…¥: rs1 (è¢«é™¤æ•°), rs2 (é™¤æ•°)
è¾“å‡º: rd (å•†/ä½™æ•°)
å‘¨æœŸæ•°: 32 cycles

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Multi-Cycle Divider Unit                     â”‚
â”‚           (Non-restoring Remainder)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚     Cycle 1: Initialization             â”‚             â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚
â”‚  â”‚  rs2 == 0?                              â”‚             â”‚
â”‚  â”‚      â”‚                                   â”‚             â”‚
â”‚  â”‚      â”œâ”€â”€â”€ Yes â”€â”€â–¶ Return Special Value  â”‚             â”‚
â”‚  â”‚      â”‚            â€¢ DIV:  -1            â”‚             â”‚
â”‚  â”‚      â”‚            â€¢ DIVU: 0xFFFFFFFF    â”‚             â”‚
â”‚  â”‚      â”‚            â€¢ REM:  rs1           â”‚             â”‚
â”‚  â”‚      â”‚            â€¢ REMU: rs1           â”‚             â”‚
â”‚  â”‚      â”‚                                   â”‚             â”‚
â”‚  â”‚      â””â”€â”€â”€ No â”€â”€â”€â–¶ Continue to Division  â”‚             â”‚
â”‚  â”‚                   â”‚                      â”‚             â”‚
â”‚  â”‚                   â–¼                      â”‚             â”‚
â”‚  â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚             â”‚
â”‚  â”‚          â”‚ Sign Detection â”‚             â”‚             â”‚
â”‚  â”‚          â”‚ & Conversion   â”‚             â”‚             â”‚
â”‚  â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                      â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚   Cycle 2-33: Iterative Division        â”‚             â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚
â”‚  â”‚                   â–¼                      â”‚             â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚             â”‚
â”‚  â”‚    â”‚   Remainder Register     â”‚         â”‚             â”‚
â”‚  â”‚    â”‚      (33-bit)            â”‚         â”‚             â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚             â”‚
â”‚  â”‚             â”‚                            â”‚             â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚             â”‚
â”‚  â”‚   â”‚                   â”‚                 â”‚             â”‚
â”‚  â”‚   â–¼                   â–¼                 â”‚             â”‚
â”‚  â”‚ R >= 0?           R < 0?                â”‚             â”‚
â”‚  â”‚   â”‚                   â”‚                 â”‚             â”‚
â”‚  â”‚   â–¼                   â–¼                 â”‚             â”‚
â”‚  â”‚ R = 2R - D        R = 2R + D            â”‚             â”‚
â”‚  â”‚ Q = Q<<1|1        Q = Q<<1|0            â”‚             â”‚
â”‚  â”‚   â”‚                   â”‚                 â”‚             â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚             â”‚
â”‚  â”‚             â”‚                            â”‚             â”‚
â”‚  â”‚             â–¼                            â”‚             â”‚
â”‚  â”‚    Repeat 32 times                      â”‚             â”‚
â”‚  â”‚    (one bit per cycle)                  â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”‚
â”‚                â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚   Cycle 34: Result Correction           â”‚           â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚
â”‚  â”‚             â–¼                            â”‚           â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚           â”‚
â”‚  â”‚    â”‚ Sign Recovery  â”‚                   â”‚           â”‚
â”‚  â”‚    â”‚ (if signed)    â”‚                   â”‚           â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚           â”‚
â”‚  â”‚             â”‚                            â”‚           â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚           â”‚
â”‚  â”‚    â”‚                 â”‚                  â”‚           â”‚
â”‚  â”‚    â–¼                 â–¼                  â”‚           â”‚
â”‚  â”‚ Quotient        Remainder               â”‚           â”‚
â”‚  â”‚    â”‚                 â”‚                  â”‚           â”‚
â”‚  â”‚    â–¼                 â–¼                  â”‚           â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”               â”‚           â”‚
â”‚  â”‚ â”‚ DIV  â”‚        â”‚ REM  â”‚               â”‚           â”‚
â”‚  â”‚ â”‚ DIVU â”‚        â”‚ REMU â”‚               â”‚           â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”˜               â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                         â”‚
â”‚  ç‰¹æ®Šæƒ…å†µå¤„ç† (RISC-V Spec):                            â”‚
â”‚  â€¢ rs2 = 0:                                            â”‚
â”‚    - DIV/DIVU â†’ -1 / 0xFFFFFFFF                        â”‚
â”‚    - REM/REMU â†’ rs1                                    â”‚
â”‚  â€¢ Overflow (DIV only):                                â”‚
â”‚    - rs1 = -2^31, rs2 = -1 â†’ Quotient = -2^31         â”‚
â”‚    -                         Remainder = 0             â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

éžæ¢å¤ä½™æ•°ç®—æ³• (Non-restoring) ä¼˜åŠ¿:
1. æ— éœ€åœ¨æ¯æ¬¡è¿­ä»£åŽåˆ¤æ–­æ˜¯å¦éœ€è¦æ¢å¤ä½™æ•°
2. é€šè¿‡ç¬¦å·ä½åˆ¤æ–­åŠ /å‡æ“ä½œï¼Œç®€åŒ–æŽ§åˆ¶é€»è¾‘
3. ç¡¬ä»¶å®žçŽ°é¢ç§¯å°ï¼ˆ~150 LUTsï¼‰
4. å»¶è¿Ÿå›ºå®šï¼ˆ32å‘¨æœŸï¼‰ï¼Œæ˜“äºŽæµæ°´çº¿æŽ§åˆ¶

æ€§èƒ½ç‰¹æ€§:
- å»¶è¿Ÿ: 32 å‘¨æœŸï¼ˆå›ºå®šï¼‰
- é¢ç§¯: ~150 LUTs
- åžåçŽ‡: 1/32 (æµæ°´çº¿æœªæ»¡æ—¶)
- vs è½¯ä»¶å®žçŽ°: 6å€æé€Ÿ


## æµ‹è¯•ç­–ç•¥ (Testing Strategy)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Testing Pyramid                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚           â”‚  Integration Tests   â”‚                      â”‚
â”‚           â”‚  â€¢ Full CPU test     â”‚                      â”‚
â”‚           â”‚  â€¢ Assembly programs â”‚                      â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                      â”‚                                   â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚         â”‚    Module Tests         â”‚                     â”‚
â”‚         â”‚  â€¢ Execution unit       â”‚                     â”‚
â”‚         â”‚  â€¢ Decoder with funct7  â”‚                     â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                  â”‚                                       â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚    â”‚     Unit Tests            â”‚                        â”‚
â”‚    â”‚  â€¢ Individual M-ext inst  â”‚                        â”‚
â”‚    â”‚  â€¢ Edge cases             â”‚                        â”‚
â”‚    â”‚  â€¢ Divide by zero         â”‚                        â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æµ‹è¯•è¦†ç›–çŽ‡ç›®æ ‡:
âœ“ åŸºæœ¬åŠŸèƒ½: æ‰€æœ‰ 8 æ¡æŒ‡ä»¤
âœ“ è¾¹ç•Œæ¡ä»¶: 0, -1, MAX_INT, MIN_INT
âœ“ ç‰¹æ®Šæƒ…å†µ: é™¤é›¶, æº¢å‡º (0x80000000 Ã· -1)
âœ“ ç»„åˆæµ‹è¯•: M-ext ä¸Ž RV32I æŒ‡ä»¤æ··åˆ
âœ“ æ€§èƒ½æµ‹è¯•: ä¸Žè½¯ä»¶å®žçŽ°å¯¹æ¯”

æµ‹è¯•ç”¨ä¾‹ç¤ºä¾‹:
â€¢ MUL:    10 Ã— 20 = 200
â€¢ MUL:    -5 Ã— 3 = -15
â€¢ MULH:   0x80000000 Ã— 2 â†’ 0x00000001 (high)
â€¢ DIV:    100 Ã· 10 = 10
â€¢ DIV:    10 Ã· 0 = -1 (special case)
â€¢ REM:    105 % 10 = 5
â€¢ REM:    10 % 0 = 10 (special case)
```

## æ€§èƒ½é¢„æœŸ (Performance Expectations - Multi-Cycle Implementation)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Performance Comparison (Updated)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  Operation        â”‚ Software  â”‚ Hardware      â”‚ Speedup   â”‚ Notes   â”‚
â”‚                   â”‚ (cycles)  â”‚ (cycles)      â”‚           â”‚         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  Multiplication   â”‚  ~100     â”‚   2-3         â”‚  33-50Ã—   â”‚ Radix-4 â”‚
â”‚  (32Ã—32â†’64)       â”‚           â”‚               â”‚           â”‚ Booth + â”‚
â”‚                   â”‚           â”‚               â”‚           â”‚ Wallace  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  Division         â”‚  ~200     â”‚   32          â”‚  ~6Ã—      â”‚ Non-    â”‚
â”‚  (32Ã·32)          â”‚           â”‚  (fixed)      â”‚           â”‚restoringâ”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  Modulo           â”‚  ~220     â”‚   32          â”‚  ~7Ã—      â”‚ Same as â”‚
â”‚  (32%32)          â”‚           â”‚  (fixed)      â”‚           â”‚ DIV     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                                                                      â”‚
â”‚  å…³é”®æ€§èƒ½æŒ‡æ ‡ (Key Performance Metrics):                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚                                                                      â”‚
â”‚  1. CPI (Cycles Per Instruction) æ”¹è¿›:                               â”‚
â”‚     â€¢ ä¹˜æ³•å¯†é›†ç¨‹åº:                                                   â”‚
â”‚       - å‰: CPI ~5.0 (æ¯ä¸ªä¹˜æ³•100å‘¨æœŸ)                               â”‚
â”‚       - åŽ: CPI ~1.3 (æ¯ä¸ªä¹˜æ³•3å‘¨æœŸ)                                 â”‚
â”‚       - æ”¹è¿›: 74% CPI é™ä½Ž                                           â”‚
â”‚                                                                      â”‚
â”‚     â€¢ é™¤æ³•å¯†é›†ç¨‹åº:                                                   â”‚
â”‚       - å‰: CPI ~10.0 (æ¯ä¸ªé™¤æ³•200å‘¨æœŸ)                              â”‚
â”‚       - åŽ: CPI ~2.2 (æ¯ä¸ªé™¤æ³•32å‘¨æœŸ)                                â”‚
â”‚       - æ”¹è¿›: 78% CPI é™ä½Ž                                           â”‚
â”‚                                                                      â”‚
â”‚  2. æ—¶é’Ÿé¢‘çŽ‡ä¿æŒ (Clock Frequency):                                  â”‚
â”‚     â€¢ Radix-4 Booth + Wallace Tree ç›¸æ¯”å•å‘¨æœŸä¹˜æ³•å™¨:                 â”‚
â”‚       - å…³é”®è·¯å¾„ç¼©çŸ­: ~60%                                           â”‚
â”‚       - é¢„è®¡é¢‘çŽ‡: 50-100 MHz (FPGA)                                  â”‚
â”‚       - å•å‘¨æœŸä¹˜æ³•å™¨ä¼šé™è‡³: 20-40 MHz                                â”‚
â”‚                                                                      â”‚
â”‚     â€¢ æ—¶é’Ÿé¢‘çŽ‡Ã—CPI ç»¼åˆæ€§èƒ½:                                         â”‚
â”‚       - å¤šå‘¨æœŸå®žçŽ°: 100MHz Ã— 1.3 = 130 MIPS (ä¹˜æ³•ç¨‹åº)              â”‚
â”‚       - å•å‘¨æœŸå®žçŽ°:  30MHz Ã— 1.0 =  30 MIPS (ä¹˜æ³•ç¨‹åº)              â”‚
â”‚       - **å®žé™…æé€Ÿ: 4.3å€**                                          â”‚
â”‚                                                                      â”‚
â”‚  3. èµ„æºæ¶ˆè€— (Resource Utilization):                                 â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚     â”‚ æ¨¡å—             â”‚ LUTs    â”‚ DSPå—    â”‚ Regs     â”‚            â”‚
â”‚     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚
â”‚     â”‚ åŽŸå§‹CPU (RV32I)  â”‚  ~3000  â”‚    0     â”‚  ~1500   â”‚            â”‚
â”‚     â”‚ + ä¹˜æ³•å™¨ (Booth) â”‚  +200   â”‚   2-4    â”‚   +150   â”‚            â”‚
â”‚     â”‚ + é™¤æ³•å™¨         â”‚  +150   â”‚    0     â”‚   +100   â”‚            â”‚
â”‚     â”‚ + æš‚åœæŽ§åˆ¶       â”‚  +50    â”‚    0     â”‚   +20    â”‚            â”‚
â”‚     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚
â”‚     â”‚ æ€»è®¡ (RV32IM)    â”‚ ~3400   â”‚   2-4    â”‚  ~1770   â”‚            â”‚
â”‚     â”‚ å¢žåŠ æ¯”ä¾‹         â”‚  +13%   â”‚   N/A    â”‚  +18%    â”‚            â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                                      â”‚
â”‚  4. å®žé™…æµ‹è¯•ç¨‹åº (workloads/multiply.exe):                           â”‚
â”‚     â€¢ å½“å‰: ä½¿ç”¨ç§»ä½+åŠ æ³•å®žçŽ° 32Ã—32 ä¹˜æ³•                             â”‚
â”‚       - æŒ‡ä»¤æ•°: ~60æ¡/æ¬¡ä¹˜æ³•                                         â”‚
â”‚       - å‘¨æœŸæ•°: ~100å‘¨æœŸ/æ¬¡ä¹˜æ³•                                      â”‚
â”‚                                                                      â”‚
â”‚     â€¢ æ”¹è¿›: ç›´æŽ¥ä½¿ç”¨ MUL æŒ‡ä»¤                                        â”‚
â”‚       - æŒ‡ä»¤æ•°: 1æ¡/æ¬¡ä¹˜æ³•                                           â”‚
â”‚       - å‘¨æœŸæ•°: 3å‘¨æœŸ/æ¬¡ä¹˜æ³•                                         â”‚
â”‚                                                                      â”‚
â”‚     â€¢ æ•´ä½“ç¨‹åºæ€§èƒ½:                                                  â”‚
â”‚       - æŒ‡ä»¤æ•°å‡å°‘: 98%                                              â”‚
â”‚       - æ‰§è¡Œå‘¨æœŸå‡å°‘: 97%                                            â”‚
â”‚       - **æ•´ä½“æé€Ÿ: ~30å€**                                          â”‚
â”‚                                                                      â”‚
â”‚  5. åŠŸè€—åˆ†æž (Power Consumption):                                    â”‚
â”‚     â€¢ å¤šå‘¨æœŸå®žçŽ° vs å•å‘¨æœŸå®žçŽ°:                                      â”‚
â”‚       - åŠ¨æ€åŠŸè€—é™ä½Ž: ~40% (é¢‘çŽ‡æ›´é«˜ä½†æ¯æ¡æŒ‡ä»¤å‘¨æœŸå°‘)                â”‚
â”‚       - é™æ€åŠŸè€—å¢žåŠ : ~15% (é¢å¤–å¯„å­˜å™¨)                              â”‚
â”‚       - å‡€æ•ˆæžœ: åŠ¨æ€åŠŸè€—ä¸»å¯¼ï¼Œæ•´ä½“é™ä½Žçº¦ 30%                         â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è®¾è®¡æƒè¡¡æ€»ç»“:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æŒ‡æ ‡                 â”‚ å•å‘¨æœŸå®žçŽ°       â”‚ å¤šå‘¨æœŸå®žçŽ°       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ä¹˜æ³•å»¶è¿Ÿ             â”‚ 1 å‘¨æœŸ           â”‚ 2-3 å‘¨æœŸ         â”‚
â”‚ æ—¶é’Ÿé¢‘çŽ‡             â”‚ ä½Ž (30 MHz)      â”‚ é«˜ (100 MHz)     â”‚
â”‚ å®žé™…æ€§èƒ½ (MIPS)      â”‚ 30               â”‚ 130              â”‚
â”‚ é¢ç§¯ (LUTs)          â”‚ å¤§ (~500)        â”‚ å° (~200)        â”‚
â”‚ åŠŸè€—                 â”‚ é«˜               â”‚ ä¸­               â”‚
â”‚ FPGA DSP åˆ©ç”¨        â”‚ å·®               â”‚ å¥½               â”‚
â”‚ å¯ç»¼åˆæ€§             â”‚ å›°éš¾             â”‚ å®¹æ˜“             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç»“è®º: å¤šå‘¨æœŸå®žçŽ°ï¼ˆRadix-4 Booth + Wallace Treeï¼‰åœ¨å®žé™…æ€§èƒ½ã€
     é¢ç§¯ã€åŠŸè€—ç­‰æ–¹é¢å…¨é¢ä¼˜äºŽå•å‘¨æœŸå®žçŽ°ï¼Œæ˜¯æ›´ä¼˜çš„å·¥ç¨‹é€‰æ‹©ã€‚
```

## æ–‡ä»¶ä¿®æ”¹æ¸…å• (File Modification Checklist)

```
ä¿®æ”¹æ–‡ä»¶ (Modified Files):
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ control_signals.py         [ä¿®æ”¹] æ‰©å±• ALUOp åˆ° Bits(32)
â”‚   â”œâ”€â”€ instruction_table.py       [ä¿®æ”¹] æ·»åŠ  8 æ¡ M-ext æŒ‡ä»¤
â”‚   â”œâ”€â”€ decoder.py                 [ä¿®æ”¹] æ”¯æŒå®Œæ•´ funct7 åŒ¹é…
â”‚   â”œâ”€â”€ execution.py               [ä¿®æ”¹] é›†æˆä¹˜æ³•å™¨å’Œé™¤æ³•å™¨æ¨¡å—
â”‚   â”œâ”€â”€ data_hazard.py             [ä¿®æ”¹] æ·»åŠ å¤šå‘¨æœŸæŒ‡ä»¤æš‚åœæŽ§åˆ¶
â”‚   â”œâ”€â”€ multiplier.py              [æ–°å»º] Radix-4 Booth + Wallace Tree ä¹˜æ³•å™¨
â”‚   â””â”€â”€ divider.py                 [æ–°å»º] éžæ¢å¤ä½™æ•°é™¤æ³•å™¨
â”‚
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ test_m_extension.py        [æ–°å»º] M-ext å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ test_multiplier.py         [æ–°å»º] ä¹˜æ³•å™¨æ¨¡å—æµ‹è¯•
â”‚   â”œâ”€â”€ test_divider.py            [æ–°å»º] é™¤æ³•å™¨æ¨¡å—æµ‹è¯•
â”‚   â”œâ”€â”€ test_multi_cycle.py        [æ–°å»º] å¤šå‘¨æœŸæŒ‡ä»¤æš‚åœæµ‹è¯•
â”‚   â””â”€â”€ test_integration.py        [ä¿®æ”¹] é›†æˆæµ‹è¯•æ›´æ–°
â”‚
â”œâ”€â”€ workloads/
â”‚   â”œâ”€â”€ mul_test.s                 [æ–°å»º] ä¹˜æ³•æµ‹è¯•æ±‡ç¼–
â”‚   â”œâ”€â”€ div_test.s                 [æ–°å»º] é™¤æ³•æµ‹è¯•æ±‡ç¼–
â”‚   â”œâ”€â”€ m_ext_benchmark.s          [æ–°å»º] M-ext æ€§èƒ½åŸºå‡†æµ‹è¯•
â”‚   â”œâ”€â”€ mul_test.exe               [æ–°å»º] ç¼–è¯‘åŽçš„ä¹˜æ³•æµ‹è¯•
â”‚   â”œâ”€â”€ div_test.exe               [æ–°å»º] ç¼–è¯‘åŽçš„é™¤æ³•æµ‹è¯•
â”‚   â””â”€â”€ m_ext_benchmark.exe        [æ–°å»º] ç¼–è¯‘åŽçš„æ€§èƒ½æµ‹è¯•
â”‚
â””â”€â”€ docs/
    â”œâ”€â”€ RV32M_Architecture_Diagram.md  [å½“å‰æ–‡æ¡£] æž¶æž„å›¾
    â”œâ”€â”€ RV32M_Radix4_Booth_Summary.md  [å®žæ–½æ€»ç»“] Radix-4 Booth å®žçŽ°
    â”œâ”€â”€ RV32M_Multiplication_Implementation.md  [å®žçŽ°è¯´æ˜Ž] ä¹˜æ³•æŒ‡ä»¤å®žçŽ°
    â”œâ”€â”€ Implementation_Summary.md      [æŠ€æœ¯æ€»ç»“] 3å‘¨æœŸä¹˜æ³•å™¨
    â”œâ”€â”€ Radix4_Booth_Wallace_Tree_Multiplier.md  [è¯¦ç»†æ–‡æ¡£] ä¹˜æ³•å™¨ç®—æ³•
    â”œâ”€â”€ Wallace_Tree_Implementation.md [å®žçŽ°ç»†èŠ‚] Wallaceæ ‘
    â””â”€â”€ Module/
        â”œâ”€â”€ EX.md                      [æ‰§è¡Œå•å…ƒ] æ–‡æ¡£
        â”œâ”€â”€ ID.md                      [è¯‘ç å™¨] æ–‡æ¡£
        â””â”€â”€ DataHazard.md              [æ•°æ®å†’é™©] å¤„ç†

é¢„è®¡ä»£ç è¡Œæ•°å˜åŒ–:
â€¢ æ–°å¢ž: ~1500 è¡Œ (åŽŸä¸º ~800 è¡Œ)
  - multiplier.py: ~400 è¡Œ (Boothç¼–ç  + Wallace Tree)
  - divider.py: ~300 è¡Œ (éžæ¢å¤ä½™æ•°ç®—æ³•)
  - æµ‹è¯•ä»£ç : ~400 è¡Œ
  - å…¶ä»–: ~400 è¡Œ
â€¢ ä¿®æ”¹: ~350 è¡Œ (åŽŸä¸º ~200 è¡Œ)
â€¢ åˆ é™¤: ~0 è¡Œ

å…³é”®æ–°å¢žæ¨¡å—:
1. src/multiplier.py
   - BoothEncoder: Radix-4 ç¼–ç å™¨ (~100 è¡Œ)
   - PartialProductGenerator: éƒ¨åˆ†ç§¯ç”Ÿæˆ (~80 è¡Œ)
   - WallaceTree: CSA æ ‘å½¢åŽ‹ç¼© (~120 è¡Œ)
   - FinalAdder: è¶…å‰è¿›ä½åŠ æ³•å™¨ (~100 è¡Œ)

2. src/divider.py
   - NonRestoringDivider: ä¸»æŽ§åˆ¶é€»è¾‘ (~100 è¡Œ)
   - DivisionIterator: è¿­ä»£å•å…ƒ (~100 è¡Œ)
   - SignHandler: ç¬¦å·å¤„ç† (~100 è¡Œ)

3. æµæ°´çº¿æš‚åœæ‰©å±• (data_hazard.py):
   - å¤šå‘¨æœŸæŒ‡ä»¤æ£€æµ‹ (~50 è¡Œ)
   - æš‚åœè®¡æ•°å™¨ç®¡ç† (~100 è¡Œ)
   - çŠ¶æ€åŒæ­¥é€»è¾‘ (~100 è¡Œ)
```

## é£Žé™©çŸ©é˜µ (Risk Matrix)

```
                  å½±å“ (Impact)
                  é«˜      ä¸­      ä½Ž
              â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
        é«˜    â”‚  ðŸ”´  â”‚  ðŸŸ¡  â”‚  ðŸŸ¢  â”‚  é™¤æ³•å™¨å»¶è¿Ÿ
æ¦‚çŽ‡          â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤
        ä¸­    â”‚  ðŸŸ¡  â”‚  ðŸŸ¡  â”‚  ðŸŸ¢  â”‚  èµ„æºæ¶ˆè€—
              â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤
        ä½Ž    â”‚  ðŸŸ¢  â”‚  ðŸŸ¢  â”‚  ðŸŸ¢  â”‚  Assassyné™åˆ¶
              â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜

é£Žé™©åº”å¯¹:
ðŸ”´ é«˜é£Žé™©: é™¤æ³•å™¨å»¶è¿Ÿè¿‡å¤§
   â†’ ç¼“è§£ç­–ç•¥: é‡‡ç”¨å¤šå‘¨æœŸå®žçŽ° + Stall

ðŸŸ¡ ä¸­é£Žé™©: FPGA èµ„æºä¸è¶³
   â†’ ç¼“è§£ç­–ç•¥: ä½¿ç”¨ DSP åŽŸè¯­, èµ„æºå¤ç”¨

ðŸŸ¢ ä½Žé£Žé™©: æ¡†æž¶ä¸æ”¯æŒå¤æ‚è¿ç®—
   â†’ ç¼“è§£ç­–ç•¥: æŸ¥é˜…æ–‡æ¡£, è”ç³»å¼€å‘è€…
```

---

**å›¾è¡¨è¯´æ˜Ž (Diagram Notes)**:
- æ‰€æœ‰å›¾è¡¨ä½¿ç”¨ ASCII å­—ç¬¦ç»˜åˆ¶ï¼Œå…¼å®¹çº¯æ–‡æœ¬æŸ¥çœ‹
- æµç¨‹å›¾ä»Žä¸Šåˆ°ä¸‹/ä»Žå·¦åˆ°å³è¡¨ç¤ºæ•°æ®æµ
- `â”‚ â”œ â”” â”Œ â” â”˜ â”¤ â”´ â”¬` ç”¨äºŽç»˜åˆ¶æ¡†æž¶
- `â–¶ â–¼ â—€ â–²` è¡¨ç¤ºæ•°æ®æµæ–¹å‘
- `âœ“ âœ—` è¡¨ç¤ºå®ŒæˆçŠ¶æ€
- `ðŸ”´ ðŸŸ¡ ðŸŸ¢` è¡¨ç¤ºé£Žé™©ç­‰çº§ï¼ˆå¦‚ä¸æ”¯æŒ emoji è¯·å¿½ç•¥ï¼‰

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¥æœŸ**: 2025-12-24
